# Enabling DKG

{% hint style="danger" %}
The SSV-DKG tool is yet to be audited. **Please refrain from using it on mainnet.**
{% endhint %}

The `ssv-dkg` tool enable operators to participate in ceremonies to generate distributed validator keys for Ethereum stakers.

The `ssv-dkg` tool is separate from the `ssv-node`, and could be running on a different machine, but the two are heavily correlated, as the keyshare generated by the `ssv-dkg` tool, will ultimately be used by the Node itself to manage the related validator.

{% hint style="info" %}
If you wish to take part in DKG ceremonies initiated by stakers and increase your opportunity to run their validators, it is crucial to have your ssv-dkg client online at all times.
{% endhint %}

## Prerequisites

In order to successfully participate in DKG ceremonies initiated by stakers, you will need to possess and/or provide this information:

* **Operator ID** - the ID of your operator within the SSV network.
* **Operator Key Pair**
  * **Public Key** - the public key of the operator&#x20;
  * **Private Key** - the private key of the operator as an password-encrypted file (follow [this guide to generate an encrypted private key file](installation.md#generate-operator-keys-encrypted) or [this migration guide to encrypt existing keys](installation.md#how-do-i-migrate-raw-deprecated-operator-keys))
* **Machine Endpoint** - the endpoint (`protocol:ip:port`) of the machine intended to run the `ssv-dkg` client (if you have a domain name, instead of an `ip` that works as well)

{% hint style="warning" %}
You must use the keys of your SSV operator as the `ssv-dkg` key pairs. Failure to do so will result in the inability to decrypt the keyshare and fulfill validator duties.
{% endhint %}

## **Start SSV-DKG**

{% hint style="info" %}
It is advised launching the tool as a Docker image as it is the most convenient way and only requires to have Docker installed. The team builds a Docker image with every release of the tool.
{% endhint %}

{% tabs %}
{% tab title="Launch with Docker and YAML file" %}
All of the necessary configuration information can be provided in a YAML file (referenced as `operator.yaml` from now on).

A good way to manage all the necessary files (`encrypted_private_key.json`, `password`) is to store them in a single folder (in this case `operator-config`), together with the `operator.yaml` configuration file, like so:

```bash
ssv@localhost:~/ssv-dkg# tree operator-config
operator-config
├── encrypted_private_key.json
├── operator.yaml
└── password

1 directory, 3 files
```

With this configuration, a typical configuration file would look like this:

{% code title="operator.yaml" %}
```yaml
privKey: /data/encrypted_private_key.json
privKeyPassword: /data/password
port: 3030
storeShare: true
logLevel: info
logFormat: json
logLevelFormat: capitalColor
logFilePath: /data/debug.log
```
{% endcode %}

{% hint style="info" %}
In the config file above, `/data/` represents the container's shared volume created by the `docker` command itself with the `-v` option.
{% endhint %}

Under the assumption that all the necessary files (`encrypted_private_key.json`, `operator.yaml`, `password`) are under the same folder (represented below with `<PATH_TO_FOLDER_WITH_CONFIG_FILES>`) you can run the tool using the command below:

```bash
docker run --restart unless-stopped --name ssv_dkg -p 3030:3030 \
-v "<PATH_TO_FOLDER_WITH_CONFIG_FILES>":/data -it \
"bloxstaking/ssv-dkg:latest" /app start-operator \
--configPath /data/operator.yaml
```

Just make sure to substitute `<PATH_TO_FOLDER_WITH_CONFIG_FILES>` with the actual folder containing all the files.

You can, of course, change the configuration above to one that suits you better, just be mindful about changing the path references in the docker command **and** in the `operator.yaml` file as well.

{% hint style="info" %}
This command will keep the terminal busy, showing the container's logs. It is useful to make sure that the tool start up sequence runs correctly.

You can detach the terminal at any time by hitting `Ctrl-c` key combination, or closing the terminal itself. The tool will be stopped, but it will restart automatically, thanks to the `--restart unless-stopped` startup parameter.

If you are sure that the tool works, and don't care about the logs, you can add the `-d` parameter right after `docker run`.
{% endhint %}
{% endtab %}

{% tab title="Build from Source" %}
A prerequisite for this is to have `go` version 1.20 installed on the system, and an optional requirement is to have the `make` tool installed as well (alternatively you could run the corresponding command defined in the `Makefile`).

#### Clone repository

Clone the `ssv-dkg` repository in your local machine:

```bash
git clone git@github.com:bloxapp/ssv-dkg.git
```

#### Build

From the project's root folder, run the following command:

<pre class="language-bash"><code class="lang-bash"><strong>make install
</strong></code></pre>

#### Launch with command line parameters

It is advised to store all the necessary files (`encrypted_private_key.json`, `password`) in a single folder (in this case `operator-config`), as shown below:

```bash
ssv@localhost:~/ssv-dkg# tree operator-config
operator-config
├── encrypted_private_key.json
└── password

1 directory, 2 files
```

To run the DKG tool as an operator, you can launch the following command with the appropriate values to each parameter:

```sh
ssv-dkg start-operator \
            --privKey ./operator-config/encrypted_private_key.json  \
            --port 3030 \
            --password ./operator-config/password \
            --storeShare true \
            --logLevel info \
            --logFormat json \
            --logLevelFormat capitalColor \
            --logFilePath ./operator-config/debug.log
```

Here's an explanation of each parameter:

<table><thead><tr><th width="307">Argument</th><th width="144.33333333333331">Type</th><th>Description</th></tr></thead><tbody><tr><td><code>--privKey</code></td><td>string</td><td>Path to private key of ssv operator</td></tr><tr><td><code>--port</code></td><td>int</td><td>Port for listening messages (default: <code>3030</code>)</td></tr><tr><td><code>--password</code></td><td>string</td><td>Path to password file to decrypt the key</td></tr><tr><td><code>--storeShare</code></td><td>bool</td><td>Whether to store the created bls key share to a file for later reuse if needed (default: <code>false</code>)</td></tr><tr><td><code>--logLevel</code></td><td>debug | info | warning | error | critical</td><td>Logger's log level (default: <code>debug</code>)</td></tr><tr><td><code>--logFormat</code></td><td>json | console</td><td>Logger's encoding (default: <code>json</code>)</td></tr><tr><td><code>--logLevelFormat</code></td><td>capitalColor | capital | lowercase</td><td>Logger's level format (default: <code>capitalColor</code>)</td></tr><tr><td><code>--logFilePath</code></td><td>string</td><td>Path to file where logs should be written (default: <code>./data/debug.log</code>)</td></tr></tbody></table>

#### Launch with YAML config file

It is also possible to use YAML configuration file, just as it was shown in the [Docker section above](enabling-dkg.md#launch-with-docker-and-yaml-file).

Just pay attention to the path of the necessary files, which needs to be changed to reflect the local configuration. If the `operator.yaml` file is created in the same folder as the other files, and the folder structure looks like this:

```
ssv@localhost:~/ssv-dkg# tree operator-config
operator-config
├── encrypted_private_key.json
├── operator.yaml
└── password

1 directory, 3 files
```

Then the content of the YAML file should be changed to this:

{% code title="operator.yaml" %}
```yaml
privKey: ./operator-config/encrypted_private_key.json
password: ./operator-config/password
port: 3030
storeShare: true
logLevel: info
logFormat: json
logLevelFormat: capitalColor
logFilePath: ./operator-config/debug.log
```
{% endcode %}

Then the tool can be launched from the root folder, by running this command:

```sh
ssv-dkg start-operator --configPath "./operator-config/operator.yaml"
```

If the `--configPath` parameter is not provided, `ssv-dkg` will be looking for a file named `config.yaml` in `./config/` folder at the same root as the binary (i.e. `./config/config.yaml`)
{% endtab %}
{% endtabs %}

## Update Operator Metadata

{% hint style="warning" %}
To participate in DKG ceremonies without coordination and to enable others to initiate ceremonies with you via your provided endpoint, it's crucial to update your operator metadata with the correct information.
{% endhint %}

Once the DKG tool is up and running, please make sure to update your operator metadata, and provide your DKG Operator endpoint, in the form of `protocol:ip:port` (if you have a domain name, instead of an `ip` that works as well).

Please head over to [the Operator User guide on how to update metadata](../operator-management/setting-operator-metadata.md) and follow the instructions
